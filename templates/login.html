<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Deep Blue Portal – Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&family=Montserrat:wght@600;700&display=swap" rel="stylesheet">

  <style>
    /* ==============================
       Base (Desktop)
       ============================== */
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background-color: #f4f7fa;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    h1, h2, h3, .left-panel h1 {
      font-family: 'Montserrat', sans-serif;
    }

    .left-panel {
      width: 50%;
      color: white;
      padding: 60px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start;
    }

    .custom-login-bg {
      background: linear-gradient(to bottom, rgba(14,58,109,0.9), rgba(14,58,109,0.9)),
                  url("{{ url_for('static', filename='images/LoginPageImage.PNG') }}") no-repeat center center;
      background-size: cover;
    }

    .left-panel img {
      width: 80px;
      margin-bottom: 30px;
      filter: brightness(0) invert(1);
    }

    .left-panel h1 {
      font-size: 36px;
      margin-bottom: 10px;
      font-style: italic;
    }

    .left-panel p {
      font-size: 18px;
      line-height: 1.5;
      max-width: 400px;
    }

    .right-panel {
      width: 50%;
      background: white;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .login-box {
      width: 350px;
      padding: 30px 40px;
      background: white;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
      border-radius: 8px;
    }

    .login-box h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }

    input[type="text"],
    input[type="password"],
    input[type="email"] {
      width: 100%;
      padding: 10px 12px;
      margin-top: 6px;
      border: 1px solid #ccc;
      border-radius: 6px; /* make both corners evenly rounded */
      box-sizing: border-box;
      appearance: none; /* remove iOS native styles */
      -webkit-appearance: none;
      -moz-appearance: none;
    }

    button {
      margin-top: 20px;
      width: 100%;
      padding: 10px;
      background-color: #0078D7;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      cursor: pointer;
    }

    button:hover { background-color: #005fa3; }

    .links {
      text-align: center;
      margin-top: 15px;
      font-size: 14px;
    }

    .links a { color: #0078D7; text-decoration: none; }

    .error, .success, .status {
      text-align: center;
      margin-top: 10px;
      font-size: 14px;
    }
    .error { color: red; }
    .success { color: green; }

    footer { display: none; }

    /* ==============================
       Modal styling (unchanged)
       ============================== */
    .modal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0; top: 0;
      width: 100%; height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.6);
    }

    .modal-content {
      background-color: #fff;
      margin: 10% auto;
      padding: 30px;
      border: 1px solid #888;
      width: 350px;
      border-radius: 8px;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
    }

    .close:hover { color: black; }

    /* ==============================
       Tablet (769–1024 px)
       ============================== */
    @media (min-width: 769px) and (max-width: 1024px) {
      body {
        flex-direction: column;
        background: #f4f7fa;
        overflow-y: auto;
      }

      .left-panel {
        width: 100%;
        height: 200px;
        background: linear-gradient(to right, #0e3a6d, #1c4c8f);
        color: #fff;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 20px;
      }

      .left-panel img {
        width: 60px;
        margin-bottom: 10px;
        filter: brightness(0) invert(1);
      }

      .left-panel h1 { font-size: 28px; margin-bottom: 8px; }
      .left-panel p { font-size: 16px; max-width: 600px; }

      .right-panel {
        width: 100%;
        justify-content: center;
        align-items: flex-start;
        background: transparent;
        margin-top: -40px;
      }

      .login-box {
        width: 90%;
        max-width: 400px;
        margin: 0 auto 3rem;
        box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        border-radius: 12px;
      }

      footer {
        display: block;
        text-align: center;
        color: #555;
        font-size: 0.8rem;
        margin-bottom: 1rem;
      }
    }

    /* ==============================
       Mobile App-like (≤768 px)
       ============================== */
    @media (max-width: 768px) {
      body, html {
        height: 100%;
        margin: 0;
        background: linear-gradient(135deg, #0e3a6d, #1c4c8f);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .left-panel { display: none; }

      .right-panel {
        width: 100%;
        max-width: 360px;
        background: #fff;
        border-radius: 14px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.25);
        padding: 2rem 1.5rem;
        text-align: center;
        flex-direction: column;
        justify-content: center;
      }

      .login-box {
        width: 100%;
        box-shadow: none;
        border-radius: 0;
        padding: 0;
      }

      .login-box h2 { color: #0e3a6d; }
      .login-box input {
        font-size: 1rem;
        padding: 0.9rem;
        border-radius: 6px;
      }

      button {
        padding: 0.9rem;
        border-radius: 6px;
        background-color: #0e3a6d;
        font-weight: 600;
      }

      .right-panel::before {
        content: "";
        display: block;
        background: url("{{ url_for('static', filename='images/DBS-Icon.png') }}") no-repeat center;
        background-size: 60px;
        width: 100%;
        height: 70px;
        margin-bottom: 1rem;
      }

      footer {
        display: block;
        text-align: center;
        color: #fff;
        font-size: 0.8rem;
        position: absolute;
        bottom: 1rem;
        width: 100%;
      }
    }
  </style>
</head>

<body>

  <div class="left-panel custom-login-bg">
    <img src="{{ url_for('static', filename='images/DBS-Icon.png') }}" alt="DBS Logo">
    <h1>Hello Demuro!</h1>
    <p>Making laytime calculations seamless. Automate time sheets, demurrage tracking, and charter party compliance with confidence.</p>
  </div>

  <div class="right-panel">
    <div class="login-box">
      <h2>Welcome Back</h2>

      {% if db_status %}
      <p class="status">{{ db_status }}</p>
      {% endif %}

      <form method="post" action="/login">
        <label for="username">Username</label>
        <input type="text" name="username" id="username" required autocapitalize="none" autocorrect="off" autocomplete="username">

        <label for="password">Password</label>
        <input type="password" name="password" id="password" required autocapitalize="none" autocorrect="off" autocomplete="current-password">

        {% if error %}
        <div class="error">{{ error }}</div>
        {% endif %}
        {% if success %}
        <div class="success">{{ success }}</div>
        {% endif %}

        <button type="submit">Log In</button>
      </form>

      <div class="links">
        <p><a href="#" onclick="openRegisterModal()">New user? Register here</a></p>
        <p><a href="#" onclick="openForgotModal()">Forgot password?</a></p>
      </div>
    </div>
  </div>

  <footer>© Deep Blue Shipping Co. Ltd.</footer>

  <!-- Forgot & Register modals unchanged -->
  <div id="forgotModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeForgotModal()">&times;</span>
      <h3>Reset Your Password</h3>
      <form method="post" action="/forgot-password">
        <label for="reset-username">Username</label>
        <input type="text" name="username" id="reset-username" required>
        <label for="reset-email">Email</label>
        <input type="email" name="email" id="reset-email" required>
        <label for="reset-password">New Password</label>
        <input type="password" name="new_password" id="reset-password" required autocomplete="new-password">
        <button type="submit">Reset Password</button>
      </form>
    </div>
  </div>

  <div id="registerModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeRegisterModal()">&times;</span>
      <h3>Register New User</h3>
      <form method="post" action="/register">
        <label for="register-key">Secret Key</label>
        <input type="text" name="secret_key" id="register-key" required>
        <label for="register-username">Username</label>
        <input type="text" name="username" id="register-username" required>
        <label for="register-email">Email</label>
        <input type="email" name="email" id="register-email" required>
        <label for="register-password">Password</label>
        <input type="password" name="password" id="register-password" required oninput="checkRegisterPasswordStrength()" autocomplete="new-password">
        <small id="register-strength-msg" style="font-size: 12px;"></small>
        <div class="show-password" style="margin-top:8px;font-size:14px;">
          <input type="checkbox" id="register-show-password" onclick="toggleRegisterPassword()"> Show Password
        </div>
        <button type="submit">Register</button>
      </form>
    </div>
  </div>

  <script>
    function openForgotModal(){document.getElementById("forgotModal").style.display="block";}
    function closeForgotModal(){document.getElementById("forgotModal").style.display="none";}
    function openRegisterModal(){document.getElementById("registerModal").style.display="block";}
    function closeRegisterModal(){document.getElementById("registerModal").style.display="none";}
    window.onclick=function(e){const f=document.getElementById("forgotModal"),r=document.getElementById("registerModal");
      if(e.target===f)f.style.display="none";if(e.target===r)r.style.display="none";}
    function checkRegisterPasswordStrength(){
      const p=document.getElementById("register-password").value,m=document.getElementById("register-strength-msg");
      let s=0;if(p.length>=8)s++;if(/[A-Z]/.test(p))s++;if(/[0-9]/.test(p))s++;if(/[^A-Za-z0-9]/.test(p))s++;
      if(s===0)m.textContent="";else if(s<=1){m.textContent="Weak password";m.style.color="red";}
      else if(s===2){m.textContent="Moderate password";m.style.color="orange";}
      else{m.textContent="Strong password";m.style.color="green";}
    }
    function toggleRegisterPassword(){
      const pw=document.getElementById("register-password");
      pw.type=pw.type==="password"?"text":"password";
    }
  </script>
</body>
</html>
