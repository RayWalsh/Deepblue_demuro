{% extends "base.html" %}
{% block title %}The Ledger | Deep Blue Portal{% endblock %}

{% block content %}

<!-- âœ… GLOBAL TABLE STYLES -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/table.css') }}">

<!-- âœ… LEDGER-SPECIFIC STYLES -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/ledger.css') }}">
<link href="https://fonts.googleapis.com/css2?family=Source+Serif+4:wght@500;600&display=swap" rel="stylesheet">

<section class="email-rules ledger-section">
  <div class="email-rules-header">
    <div class="header-left">
      <h1>The Ledger</h1>
      <p class="mailbox-subtitle">
        Manage financial transactions and ledger entries for Deep Blue.
      </p>
    </div>

    <div class="header-right">
      <input
        id="globalSearch"
        type="text"
        class="search-bar"
        placeholder="Search ledger..."
      />

      <button id="exportCSVBtn" class="header-add-btn" title="Export CSV">
        <i class="fas fa-file-csv"></i>
      </button>

      <button id="openAddEntryBtn" class="header-add-btn" title="Add New Entry">
        <i class="fas fa-plus"></i>
      </button>

      <button id="openSettingsBtn" class="header-add-btn" title="Settings">
        <i class="fas fa-cog"></i>
      </button>

      <button id="toggleViewBtn" class="header-add-btn" title="Switch View">
        <i class="fas fa-table"></i>
      </button>
    </div>
  </div>

  <!-- ===========================
       ðŸ“Š Ledger Table
  ============================ -->
  <div id="ledger-table" class="table-wrapper">
    <div class="table-scroll">
      <table id="ledgerTable" class="data-table">
        <thead>
          <!-- âš ï¸ Headers are built dynamically by ledger.js -->
          <tr></tr>
        </thead>

        <tbody id="ledgerTableBody">
          <tr>
            <td colspan="100%">Loadingâ€¦</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</section>

<!-- ===============================
     âž• Add Entry Modal
     =============================== -->
<div id="addEntryModal" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Add New Ledger Entry</h3>
      <div class="modal-actions">
        <button id="saveAddEntryBtn" class="header-add-btn small">ðŸ’¾ Save</button>
        <button id="closeAddEntryBtn" class="close-btn">&times;</button>
      </div>
    </div>

    <div id="addModalBody" class="modal-body">
      <p>Loading form...</p>
    </div>
  </div>
</div>

<!-- ===============================
     âœï¸ Edit Entry Modal
     =============================== -->
<div id="editEntryModal" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-header">
      <h3 id="editModalTitle">Edit Ledger Entry</h3>
      <div class="modal-actions">
        <button id="saveEntryBtn" class="header-add-btn small">ðŸ’¾ Save</button>
        <button id="deleteEntryBtn" class="header-add-btn small danger">ðŸ—‘ Delete</button>
        <button id="closeEditEntryBtn" class="close-btn">&times;</button>
      </div>
    </div>

    <div id="editModalBody" class="modal-body">
      <p>Loading entry...</p>
    </div>
  </div>
</div>

<!-- ===============================
     âš™ï¸ Settings Modal
     =============================== -->
<div id="settingsModal" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Ledger Settings</h3>
      <button id="closeSettingsBtn" class="close-btn">&times;</button>
    </div>

    <div class="modal-body">
      <h4>Ledger Preferences</h4>
      <p>
        Here youâ€™ll soon be able to configure field options,
        column visibility, and view preferences.
      </p>
    </div>
  </div>
</div>

<!-- =========================================
     Edit Column Side Modal (Shell Only)
========================================= -->
<div id="editColumnModal" class="side-modal">
  <!-- Header -->
  <div class="side-modal-header">
    <h3>Edit column</h3>
    <button id="closeEditColumnModal" class="close-btn">&times;</button>
  </div>

  <!-- Body -->
  <div class="side-modal-body">
    <div class="form-group">
      <label for="editColumnName">Name</label>
      <input
        id="editColumnName"
        type="text"
        value=""
        disabled
      />
    </div>

    <div class="form-group">
      <label for="editColumnDescription">Description</label>
      <textarea
        id="editColumnDescription"
        rows="3"
        placeholder="Add a description for this column"
        disabled
      ></textarea>
    </div>

    <p class="muted">
      Column settings and validation options will appear here.
    </p>
  </div>

  <!-- Footer -->
  <div class="side-modal-footer">
    <button class="secondary-btn" id="cancelEditColumn">
      Cancel
    </button>
    <button class="danger-btn" disabled>
      Delete
    </button>
    <button class="header-add-btn small" disabled>
      Save
    </button>
  </div>
</div>

<!-- ===============================
     ðŸ“Š Column Header Menu (Sort)
     =============================== -->
<div id="columnMenu" class="column-menu">
  <button data-sort="asc">
    Sort A â†’ Z <span class="tick">âœ“</span>
  </button>

  <button data-sort="desc">
    Sort Z â†’ A <span class="tick">âœ“</span>
  </button>

  <div class="menu-divider"></div>

  <button id="editColumnBtn">
    Edit column <span class="tick tick-spacer">âœ“</span>
  </button>
</div>


<script src="{{ url_for('static', filename='js/ledger.js') }}"></script>
{% endblock %}